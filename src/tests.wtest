import wollok.game.*
import enemigos.*
import nave.*
import disparo.*
import nivel.*


describe "juego"{
	const invasor = invasorFuerteFactory.crearInvasor(game.at(1,2),nivel1)
	const invasorV = invasorVerdeFactory.crearInvasor(game.at(1,3),nivel1)
	const bala = balaFactory.crearBala(nave1)
	
	method initialize(){
		game.width(31)
		game.height(19)
	
	}
	
	test "testeo de Da√±o y posicion de la bala" {
		
		assert.equals(game.at(12,1),bala.position())
		
		nivel1.nave(nave1)
		invasor.atacado(1)
		assert.equals( 2,invasor.vida() )

	}
	test "creacion de enemigos"{
		assert.equals(game.at(1,2),invasor.position())
		assert.equals( 2,nivel1.enemigos().size())// se tiene en cuenta los invasores creados en el describe
		nivel1.posiciones(#{game.at(5,5),game.at(7,10),game.at(8,6)})
		invasorFactory.crearInvasores(0,nivel1.posiciones(),nivel1)
		
		assert.equals( 5,nivel1.enemigos().size())
	}
	test "muerte de enemigo" {
		assert.equals( 2,nivel1.enemigos().size())
		invasorV.atacado(1)
		assert.equals( 1,nivel1.enemigos().size())
	}
	
}

describe "nave" {
	const invasor = invasorFuerteFactory.crearInvasor(game.at(1,2),nivel1)
	
	method initialize(){
		game.width(31)
		game.height(19)
	
	}
	
	test "la nave en posicion 12,0 y un alien lo choca, fin del juego" {
		game.addVisual(nave1)
		invasor.colision(nave1)
		assert.equals(#{nave1}, game.allVisuals().asSet())
	}
}





